<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate Model Based LOD and LOQ for qPCR eDNA Assays — calib_lod • ednar</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate Model Based LOD and LOQ for qPCR eDNA Assays — calib_lod" />
<meta property="og:description" content="Calculate threshold and model based LOD and LOQ for qPCR eDNA assays based on one or
    more standard curves. This code has been modified and functionalised from the original
    by Merkes et al. (see references)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ednar</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/alexd106/ednar/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate Model Based LOD and LOQ for qPCR eDNA Assays</h1>
    <small class="dont-index">Source: <a href='https://github.com/alexd106/ednar/blob/master/R/calib_lod.R'><code>R/calib_lod.R</code></a></small>
    <div class="hidden name"><code>calib_lod.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate threshold and model based LOD and LOQ for qPCR eDNA assays based on one or
    more standard curves. This code has been modified and functionalised from the original
    by Merkes et al. (see references).</p>
    </div>

    <pre class="usage"><span class='fu'>calib_lod</span>(<span class='no'>data</span>, <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>0.35</span>, <span class='kw'>lod.fit</span> <span class='kw'>=</span> <span class='st'>"best"</span>, <span class='kw'>loq.fit</span> <span class='kw'>=</span> <span class='st'>"best"</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></code> or <code>tibble</code> object containing calibration curve data.</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>Threshold value for LOQ calculation using coefficient of variation (CV) of Cq (Ct)
values. Default value = 0.35.</p></td>
    </tr>
    <tr>
      <th>lod.fit</th>
      <td><p>Character string to specify method to estimate LOD. Default: <code>'best'</code>. See details for other
possible values.</p></td>
    </tr>
    <tr>
      <th>loq.fit</th>
      <td><p>Character string to specify method to estimate LOQ based on CV curves. Default: <code>'best'</code>.
Other option include <code>'decay'</code>, <code>'linear'</code> and <code>'Pn'</code> (see details).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code><a href='https://rdrr.io/r/base/list.html'>list</a></code> object containing elements <code>dataSum</code>, <code>standardsSum</code> and <code>assaySum</code>.</p>
<p><code>dataSum</code>: A summary of the original calibration data with copy number estimate (<code>Copy.Estimate</code>).</p>
<p><code>standardsSum</code>: A summary of the number of replicates (<code>Rep</code>), number of detections (<code>Detects</code>)
    and detection rate (<code>Rate</code>) for each standard (<code>Standards</code>) and Target (<code>Target</code>) combination.
    The mean (<code>Cq.mean</code>), standard deviation (<code>Cq.sd</code>) and coefficient of variation (<code>Cq.CV</code>) of
    Cq values and also the coefficient of variation of copy number (<code>Copy.CV</code>) is given.</p>
<p><code>assaySum</code>: A summary of the qPCR assay containing the following variables:</p>
<p><code>R.squared</code>: The R-squared value of linear regression of all standards Cq-values vs log10 of the starting quantities.</p>
<p><code>Slope</code>: The slope of the linear regression.</p>
<p><code>Intercept</code>: The intercept of the linear regression.</p>
<p><code>Low.95</code>: The lowest standard with at least 95<!-- % positive detection. --></p>
<p><code>LOD</code>: The 95<!-- % limit of detection as determined by dose-response modelling. --></p>
<p><code>LOQ</code>: The limit of quantification as determined by decay modelling, using the user-selected CV threshold.</p>
<p><code>rep2.LOD</code>: The effective limit of detection if analysing in 2 replicates.</p>
<p><code>rep3.LOD</code>: The effective limit of detection if analysing in 3 replicates.</p>
<p><code>rep4.LOD</code>: The effective limit of detection if analysing in 4 replicates.</p>
<p><code>rep5.LOD</code>: The effective limit of detection if analysing in 5 replicates.</p>
<p><code>rep8.LOD</code>: The effective limit of detection if analysing in 8 replicates.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>data</code> object contains data for at least one qPCR calibration curve
   usually presented as Cq (Ct) value and corresponding copy number from from a series of serial dilutions.
   The <code>data.frame</code> must contain the headers <code>Target</code>, <code>Cq</code> and <code>SQ</code>. The <code>Target</code>
   column must contain unique identifiers for each calibration curve. The <code>Cq</code> column contains the
   Cq (Ct) values and <code>SQ</code> contains the copy number data. Additional columns will be ignored. Non-detections
   in <code>data</code> should be represented as <code>NA</code>.</p>
<p>The <code>lod.fit</code> argument is used to select the method to estimate LOD. Selecting 'best' will automatically
   fit 15 models available from the package <code>drc</code> and perform model selection based on log
   likelihood values, Akaike's information criterion and residual variance using the <code><a href='https://rdrr.io/pkg/drc/man/mselect.html'>mselect</a></code>
   function. Information on other possible models can be displayed by running the <code><a href='https://rdrr.io/pkg/drc/man/getMeanFunctions.html'>getMeanFunctions</a></code>
   function. For example to fit a 4 parameter Weibull type II model use <code>lod.fit = 'W2.4()'</code>.</p>
<p>The <code>loq.fit</code> argument is used to select the method to estimate LOQ. Selecting 'best' will automatically
   select the model with lowest residual standard error. 'decay' uses the exponential decay model, 'linear'
   uses a linear model and 'Pn' fits an nth-order polynomial model where n is numerical. For example,
   <code>loq.fit = 'P2'</code> will fit a 2nd-order polynomial model and <code>loq.fit = 'Ps'</code> will use a 3rd-order.
   Selecting 'best' will test polynomial models up to 6th-order.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Merkes CM, Klymus KE, Allison MJ, Goldberg C, Helbing CC, Hunter ME, Jackson CA, Lance RF,
    Mangan AM, Monroe EM, Piaggio AJ, Stokdyk JP, Wilson CC, Richter C. (2019) Generic qPCR Limit of
    Detection (LOD) / Limit of Quantification (LOQ) calculator. R Script.
    Available at: https://github.com/cmerkes/qPCR_LOD_Calc. DOI: https://doi.org/10.5066/P9GT00GB.</p>
<p>Klymus, Katy E., Christopher M. Merkes, Michael J. Allison, Caren S. Goldberg, Caren C. Helbing,
    Margaret E. Hunter, Craig A. Jackson, et al. ‘Reporting the Limits of Detection and Quantification
    for Environmental DNA Assays’. Environmental DNA 2, no. 3 (July 2020): 271–82.
    https://doi.org/10.1002/edn3.29.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
 <span class='no'>qpcr_lod</span> <span class='kw'>&lt;-</span> <span class='fu'>calib_lod</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>calib_data</span>, <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>0.35</span>,
               <span class='kw'>lod.fit</span> <span class='kw'>=</span> <span class='st'>"best"</span>, <span class='kw'>loq.fit</span> <span class='kw'>=</span> <span class='st'>"best"</span>)
 <span class='no'>qpcr_lod</span>

 <span class='no'>qpcr_lod_decay</span> <span class='kw'>&lt;-</span> <span class='fu'>calib_lod</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>calib_data</span>, <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>0.35</span>,
                     <span class='kw'>lod.fit</span> <span class='kw'>=</span> <span class='st'>"best"</span>, <span class='kw'>loq.fit</span> <span class='kw'>=</span> <span class='st'>"decay"</span>)

 <span class='no'>qpcr_lod_W2</span> <span class='kw'>&lt;-</span> <span class='fu'>calib_lod</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>calib_data</span>, <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>0.35</span>,
                  <span class='kw'>lod.fit</span> <span class='kw'>=</span> <span class='st'>"W2.4()"</span>, <span class='kw'>loq.fit</span> <span class='kw'>=</span> <span class='st'>"best"</span>)
 <span class='no'>qpcr_lod_W2</span>
 }</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alex Douglas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


